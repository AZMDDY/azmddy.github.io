(window.webpackJsonp=window.webpackJsonp||[]).push([[17],{509:function(e,s,n){"use strict";n.r(s);var a=n(22),t=Object(a.a)({},(function(){var e=this,s=e.$createElement,n=e._self._c||s;return n("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[n("h1",{attrs:{id:"cmake-day-5-从-cmakelists-txt-传递变量到源文件"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#cmake-day-5-从-cmakelists-txt-传递变量到源文件"}},[e._v("#")]),e._v(" CMake Day 5 —— 从 CMakeLists.txt 传递变量到源文件")]),e._v(" "),n("p",[e._v("语法：")]),e._v(" "),n("div",{staticClass:"language-text line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v("configure_file(&lt;input> &lt;output>\n               [COPYONLY] [ESCAPE_QUOTES] [@ONLY]\n               [NO_SOURCE_PERMISSIONS]\n               [NEWLINE_STYLE [UNIX|DOS|WIN32|LF|CRLF] ])\n")])]),e._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[e._v("1")]),n("br"),n("span",{staticClass:"line-number"},[e._v("2")]),n("br"),n("span",{staticClass:"line-number"},[e._v("3")]),n("br"),n("span",{staticClass:"line-number"},[e._v("4")]),n("br")])]),n("p",[e._v("将"),n("code",[e._v("<input>")]),e._v("文件复制到"),n("code",[e._v("<output>")]),e._v("文件，并在输入的文件内容中替换"),n("code",[e._v("@VAR@")]),e._v("或"),n("code",[e._v("${VAR}")]),e._v("的变量值，每个变量的引用都会被替换为该变量当前的值，如果变量未定义，则为空字符串。")]),e._v(" "),n("p",[n("code",[e._v("<input>")]),e._v("文件中定义变量替换的形式如下：")]),e._v(" "),n("div",{staticClass:"language-C++ line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v("#cmakedefine VAR ...\n")])]),e._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[e._v("1")]),n("br")])]),n("p",[e._v("这将会被替换成：")]),e._v(" "),n("div",{staticClass:"language-C++ line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v("#define VAR ...\n")])]),e._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[e._v("1")]),n("br")])]),n("p",[e._v("或者:")]),e._v(" "),n("div",{staticClass:"language-C++ line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v("/* #undef VAR */\n")])]),e._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[e._v("1")]),n("br")])]),n("p",[e._v("当"),n("code",[e._v("input")]),e._v("文件被修改时，需要运行 CMake 以重新配置文件。")]),e._v(" "),n("ul",[n("li",[n("code",[e._v("<input>")]),e._v("：输入文件的路径，相对路径是相对于"),n("code",[e._v("CMAKE_CURRENT_SOURCE_DIR")]),e._v("，必须是文件，不能是目录；")]),e._v(" "),n("li",[n("code",[e._v("<output>")]),e._v("：输入文件或目录的路径，相对路径是相对于"),n("code",[e._v("CMAKE_CURRENT_BINARY_DIR")]),e._v("，如果是现有的目录，则输出文件和输入文件同名；")]),e._v(" "),n("li",[n("code",[e._v("COPYONLY")]),e._v(": 表示复制文件，而不替换任何变量引用和其它内容；")]),e._v(" "),n("li",[n("code",[e._v("ESCAPE_QUOTES")]),e._v(": 表示用反斜杠替换任何引号；")]),e._v(" "),n("li",[n("code",[e._v("@ONLY")]),e._v("：仅仅替换"),n("code",[e._v("@VAR@")]),e._v("形式的变量引用；")]),e._v(" "),n("li",[n("code",[e._v("NO_SOURCE_PERMISSIONS")]),e._v("：不会将原始文件权限转移到副本，复制的文件权限默认 644，PS:有些 CMake 版本不支持这个参数；")]),e._v(" "),n("li",[n("code",[e._v("NEWLINE_STYLE <style>")]),e._v("：指定输出文件的换行形式；")])]),e._v(" "),n("p",[n("code",[e._v("CMAKE_CURRENT_BINARY_DIR")]),e._v("：cmake 的构建目录；")]),e._v(" "),n("p",[e._v("示例：")]),e._v(" "),n("div",{staticClass:"language-CMakeLists.txt line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v('cmake_minimum_required(VERSION 3.10.0)\n\nproject(demo)\n\ninclude_directories(${CMAKE_SOURCE_DIR})\ninclude_directories(${CMAKE_CURRENT_BINARY_DIR})\n\nset(VAR1 "1222")\nset(VAR2 2)\nset(VAR3)\nset(VAR4 "\\"QAZ\\"")\nset(VAR5 "BABA")\n\nconfigure_file(Config.h.in Config.h)\n\nconfigure_file(Config.h.in Config1.h ESCAPE_QUOTES @ONLY NEWLINE_STYLE CRLF)\nconfigure_file(Config.h.in ./ COPYONLY)\nadd_executable(demo main.cpp)\n\n')])]),e._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[e._v("1")]),n("br"),n("span",{staticClass:"line-number"},[e._v("2")]),n("br"),n("span",{staticClass:"line-number"},[e._v("3")]),n("br"),n("span",{staticClass:"line-number"},[e._v("4")]),n("br"),n("span",{staticClass:"line-number"},[e._v("5")]),n("br"),n("span",{staticClass:"line-number"},[e._v("6")]),n("br"),n("span",{staticClass:"line-number"},[e._v("7")]),n("br"),n("span",{staticClass:"line-number"},[e._v("8")]),n("br"),n("span",{staticClass:"line-number"},[e._v("9")]),n("br"),n("span",{staticClass:"line-number"},[e._v("10")]),n("br"),n("span",{staticClass:"line-number"},[e._v("11")]),n("br"),n("span",{staticClass:"line-number"},[e._v("12")]),n("br"),n("span",{staticClass:"line-number"},[e._v("13")]),n("br"),n("span",{staticClass:"line-number"},[e._v("14")]),n("br"),n("span",{staticClass:"line-number"},[e._v("15")]),n("br"),n("span",{staticClass:"line-number"},[e._v("16")]),n("br"),n("span",{staticClass:"line-number"},[e._v("17")]),n("br"),n("span",{staticClass:"line-number"},[e._v("18")]),n("br"),n("span",{staticClass:"line-number"},[e._v("19")]),n("br")])]),n("p",[n("a",{attrs:{href:"https://github.com/AZMDDY/cmake-demo/tree/main/cmake-day-5",target:"_blank",rel:"noopener noreferrer"}},[e._v("https://github.com/AZMDDY/cmake-demo/tree/main/cmake-day-5"),n("OutboundLink")],1)])])}),[],!1,null,null,null);s.default=t.exports}}]);