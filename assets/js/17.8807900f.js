(window.webpackJsonp=window.webpackJsonp||[]).push([[17],{340:function(a,s,e){"use strict";e.r(s);var n=e(4),_=Object(n.a)({},(function(){var a=this,s=a._self._c;return s("ContentSlotsDistributor",{attrs:{"slot-key":a.$parent.slotKey}},[s("h1",{attrs:{id:"cmake-day-3-编译二进制或库"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#cmake-day-3-编译二进制或库"}},[a._v("#")]),a._v(" CMake Day 3 —— 编译二进制或库")]),a._v(" "),s("p",[a._v("我们可以通过"),s("code",[a._v("add_executable")]),a._v("命令来将项目编译成一个二进制文件，通过"),s("code",[a._v("add_library")]),a._v("将项目编译编译成一个库。")]),a._v(" "),s("p",[a._v("项目结构如下：")]),a._v(" "),s("div",{staticClass:"language-text line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("demo\n​ ├── build\n    ​ └── lib\n    ​ └── bin\n​ ├── CMakeLists.txt\n​ ├── add.h\n​ ├── add.cpp\n​ └── main.cpp\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br"),s("span",{staticClass:"line-number"},[a._v("3")]),s("br"),s("span",{staticClass:"line-number"},[a._v("4")]),s("br"),s("span",{staticClass:"line-number"},[a._v("5")]),s("br"),s("span",{staticClass:"line-number"},[a._v("6")]),s("br"),s("span",{staticClass:"line-number"},[a._v("7")]),s("br"),s("span",{staticClass:"line-number"},[a._v("8")]),s("br")])]),s("div",{staticClass:"language-CMakeLists.txt line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("# CMake的最小版本要求\ncmake_minimum_required(VERSION 3.0.0)\n# 项目名称以及版本号\nproject(demo VERSION 0.1.0)\n\n#启动对C++14标准的支持\nset(CMAKE_CXX_STANDARD 14)\n\n# 显式要求指明支持C++标准\nset(CMAKE_CXX_STANDARD_REQUIRED True)\n\n# 归档静态库到指定目录\nset(CMAKE_ARCHIVE_OUTPUT_DIRECTORY ${CMAKE_SOURCE_DIR}/build/lib)\n# 归档动态库到指定目录\nset(CMAKE_LIBRARY_OUTPUT_DIRECTORY ${CMAKE_SOURCE_DIR}/build/lib)\n# 归档可执行文件到指定目录\nset(CMAKE_RUNTIME_OUTPUT_DIRECTORY ${CMAKE_SOURCE_DIR}/build/bin)\n\n#设置可执行程序\nadd_executable(demo main.cpp)\n\n#设置动态库\nadd_library(add SHARED add.cpp)\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br"),s("span",{staticClass:"line-number"},[a._v("3")]),s("br"),s("span",{staticClass:"line-number"},[a._v("4")]),s("br"),s("span",{staticClass:"line-number"},[a._v("5")]),s("br"),s("span",{staticClass:"line-number"},[a._v("6")]),s("br"),s("span",{staticClass:"line-number"},[a._v("7")]),s("br"),s("span",{staticClass:"line-number"},[a._v("8")]),s("br"),s("span",{staticClass:"line-number"},[a._v("9")]),s("br"),s("span",{staticClass:"line-number"},[a._v("10")]),s("br"),s("span",{staticClass:"line-number"},[a._v("11")]),s("br"),s("span",{staticClass:"line-number"},[a._v("12")]),s("br"),s("span",{staticClass:"line-number"},[a._v("13")]),s("br"),s("span",{staticClass:"line-number"},[a._v("14")]),s("br"),s("span",{staticClass:"line-number"},[a._v("15")]),s("br"),s("span",{staticClass:"line-number"},[a._v("16")]),s("br"),s("span",{staticClass:"line-number"},[a._v("17")]),s("br"),s("span",{staticClass:"line-number"},[a._v("18")]),s("br"),s("span",{staticClass:"line-number"},[a._v("19")]),s("br"),s("span",{staticClass:"line-number"},[a._v("20")]),s("br"),s("span",{staticClass:"line-number"},[a._v("21")]),s("br"),s("span",{staticClass:"line-number"},[a._v("22")]),s("br"),s("span",{staticClass:"line-number"},[a._v("23")]),s("br")])]),s("h2",{attrs:{id:"add-executable"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#add-executable"}},[a._v("#")]),a._v(" add_executable")]),a._v(" "),s("p",[a._v("语法：")]),a._v(" "),s("div",{staticClass:"language-text line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("add_executable(&lt;name> [WIN32] [MACOSX_BUNDLE]\n               [EXCLUDE_FROM_ALL]\n               [source1] [source2 ...])\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br"),s("span",{staticClass:"line-number"},[a._v("3")]),s("br")])]),s("p",[a._v("名为"),s("code",[a._v("<name>")]),a._v("的可执行文件将会从源文件列表中被构建，其中"),s("code",[a._v("<name>")]),a._v("需要在整个项目中全局唯一，构建出的的实际文件名是基于平台的约定构建的，例如:"),s("code",[a._v("<name>.exe")]),a._v("或者"),s("code",[a._v("<name>")]),a._v("。")]),a._v(" "),s("p",[a._v("默认情况下，可执行文件将会在该项目的构建树目录中被创建。可以通过"),s("code",[a._v("CMAKE_RUNTIME_OUTPUT_DIRECTORY")]),a._v("来改变可执行文件的归档路径。")]),a._v(" "),s("ul",[s("li",[a._v("CMAKE_RUNTIME_OUTPUT_DIRECTORY：是归档可执行文件到指定目录；")])]),a._v(" "),s("p",[s("code",[a._v("WIN32")]),a._v("是指在 Windows 上使用 WinMain 入口点创建可执行文件。\n"),s("code",[a._v("MACOSX_BUNDLE")]),a._v("是指在 macOS 或 IOS 上构建的可执行文件。")]),a._v(" "),s("h2",{attrs:{id:"add-library"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#add-library"}},[a._v("#")]),a._v(" add_library")]),a._v(" "),s("p",[a._v("语法：")]),a._v(" "),s("div",{staticClass:"language-text line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("add_library(&lt;name> [STATIC | SHARED | MODULE]\n            [EXCLUDE_FROM_ALL]\n            [&lt;source>...])\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br"),s("span",{staticClass:"line-number"},[a._v("3")]),s("br")])]),s("p",[a._v("名为"),s("code",[a._v("<name>")]),a._v("的库将会从源文件列表中被构建，其中"),s("code",[a._v("<name>")]),a._v("需要在整个项目中全局唯一，构建出的的实际文件名是基于平台的约定构建的，例如"),s("code",[a._v("libdemo.a/libdemo.so")]),a._v("或者"),s("code",[a._v("demo.lib/demo.dll")]),a._v("。")]),a._v(" "),s("p",[a._v("通过指定"),s("code",[a._v("STATIC")]),a._v("，"),s("code",[a._v("SHARED")]),a._v("，"),s("code",[a._v("MODULE")]),a._v("来指定要创建库的类型。"),s("code",[a._v("STATIC")]),a._v("是静态库，"),s("code",[a._v("SHARED")]),a._v("是动态库，"),s("code",[a._v("MODULE")]),a._v("是未链接到其它目标的插件，但可以使用"),s("code",[a._v("dlopen")]),a._v("等方式在运行期间被动态加载。")]),a._v(" "),s("p",[a._v("如果没有明确指定库的类型，可以通过"),s("code",[a._v("BUILD_SHARED_LIBS")]),a._v("的值是否为"),s("code",[a._v("ON")]),a._v("来指定库的类型是"),s("code",[a._v("SHARED")]),a._v("还是"),s("code",[a._v("STATIC")]),a._v("，注意：这个参数是全局标志，默认是"),s("code",[a._v("OFF")]),a._v("。")]),a._v(" "),s("p",[a._v("默认情况下，库文件将会在该项目的构建树目录中被创建，例如：项目中需要将不同文件夹中的代码编译成库，构建目录中会生成对于的构建树，库文件就在对应的目录中。但是我们可以通过"),s("code",[a._v("CMAKE_ARCHIVE_OUTPUT_DIRECTORY")]),a._v(","),s("code",[a._v("CMAKE_LIBRARY_OUTPUT_DIRECTORY")]),a._v("参数来改变库文件生成的路径。")]),a._v(" "),s("ul",[s("li",[a._v("CMAKE_ARCHIVE_OUTPUT_DIRECTORY：是归档静态库到指定目录；")]),a._v(" "),s("li",[a._v("CMAKE_LIBRARY_OUTPUT_DIRECTORY: 是归档动态库到指定目录；")])])])}),[],!1,null,null,null);s.default=_.exports}}]);